/*jslint unparam: true, browser: true, indent: 2 */(function(e,t,n,r){"use strict";Foundation.libs.forms={name:"forms",version:"4.0.0",settings:{disable_class:"no-custom"},init:function(t,n,r){this.scope=t||this.scope;typeof n=="object"&&e.extend(!0,this.settings,n);if(typeof n!="string"){this.settings.init||this.events();this.assemble();return this.settings.init}return this[n].call(this,r)},assemble:function(){e('form.custom input[type="radio"]').not('[data-customforms="disabled"]').each(this.append_custom_markup);e('form.custom input[type="checkbox"]').not('[data-customforms="disabled"]').each(this.append_custom_markup);e("form.custom select").not('[data-customforms="disabled"]').each(this.append_custom_select)},events:function(){var t=this;e(this.scope).on("click.fndtn.forms","form.custom span.custom.checkbox",function(n){n.preventDefault();n.stopPropagation();t.toggle_checkbox(e(this))}).on("click.fndtn.forms","form.custom span.custom.radio",function(n){n.preventDefault();n.stopPropagation();t.toggle_radio(e(this))}).on("change.fndtn.forms",'form.custom select:not([data-customforms="disabled"])',function(n){t.refresh_custom_select(e(this))}).on("click.fndtn.forms","form.custom label",function(n){var r=e("#"+t.escape(e(this).attr("for"))+':not([data-customforms="disabled"])'),i,s;if(r.length!==0)if(r.attr("type")==="checkbox"){n.preventDefault();i=e(this).find("span.custom.checkbox");i.length==0&&(i=e(this).next("span.custom.checkbox"));i.length==0&&(i=e(this).prev("span.custom.checkbox"));t.toggle_checkbox(i)}else if(r.attr("type")==="radio"){n.preventDefault();s=e(this).find("span.custom.radio");s.length==0&&(s=e(this).next("span.custom.radio"));s.length==0&&(s=e(this).prev("span.custom.radio"));t.toggle_radio(s)}}).on("click.fndtn.forms","form.custom div.custom.dropdown a.current, form.custom div.custom.dropdown a.selector",function(n){var r=e(this),i=r.closest("div.custom.dropdown"),s=i.prev();i.hasClass("open")||e(t.scope).trigger("click");n.preventDefault();if(!1===s.is(":disabled")){i.toggleClass("open");i.hasClass("open")?e(t.scope).on("click.fndtn.forms.customdropdown",function(){i.removeClass("open");e(t.scope).off(".fndtn.forms.customdropdown")}):e(t.scope).on(".fndtn.forms.customdropdown");return!1}}).on("click.fndtn.forms touchend.fndtn.forms","form.custom div.custom.dropdown li",function(t){var n=e(this),r=n.closest("div.custom.dropdown"),i=r.prev(),s=0;t.preventDefault();t.stopPropagation();if(!e(this).hasClass("disabled")){e("div.dropdown").not(r).removeClass("open");var o=n.closest("ul").find("li.selected");o.removeClass("selected");n.addClass("selected");r.removeClass("open").find("a.current").html(n.html());n.closest("ul").find("li").each(function(e){n[0]==this&&(s=e)});i[0].selectedIndex=s;i.data("prevalue",o.html());i.trigger("change")}});this.settings.init=!0},append_custom_markup:function(t,n){var r=e(n).hide(),i=r.attr("type"),s=r.next("span.custom."+i);s.length===0&&(s=e('<span class="custom '+i+'"></span>').insertAfter(r));s.toggleClass("checked",r.is(":checked"));s.toggleClass("disabled",r.is(":disabled"))},append_custom_select:function(t,n){var r=Foundation.libs.forms,i=e(n),s=i.next("div.custom.dropdown"),o=s.find("ul"),u=s.find(".current"),a=s.find(".selector"),f=i.find("option"),l=f.filter(":selected"),c=0,h="",p,d=!1;if(i.hasClass(r.settings.disable_class))return;if(s.length===0){var v=i.hasClass("small")?"small":i.hasClass("medium")?"medium":i.hasClass("large")?"large":i.hasClass("expand")?"expand":"";s=e('<div class="'+["custom","dropdown",v].join(" ")+'"><a href="#" class="selector"></a><ul /></div>');a=s.find(".selector");o=s.find("ul");h=f.map(function(){return"<li>"+e(this).html()+"</li>"}).get().join("");o.append(h);d=s.prepend('<a href="#" class="current">'+l.html()+"</a>").find(".current");i.after(s).hide()}else{h=f.map(function(){return"<li>"+e(this).html()+"</li>"}).get().join("");o.html("").append(h)}s.toggleClass("disabled",i.is(":disabled"));p=o.find("li");f.each(function(t){if(this.selected){p.eq(t).addClass("selected");d&&d.html(e(this).html())}e(this).is(":disabled")&&p.eq(t).addClass("disabled")});if(!s.is(".small, .medium, .large, .expand")){s.addClass("open");var r=Foundation.libs.forms;r.hidden_fix.adjust(o);c=r.outerWidth(p)>c?r.outerWidth(p):c;Foundation.libs.forms.hidden_fix.reset();s.removeClass("open")}},refresh_custom_select:function(t){var n=this,r=0,i=t.next(),s=t.find("option");i.find("ul").html("");s.each(function(){var t=e("<li>"+e(this).html()+"</li>");i.find("ul").append(t)});s.each(function(t){if(this.selected){i.find("li").eq(t).addClass("selected");i.find(".current").html(e(this).html())}e(this).is(":disabled")&&i.find("li").eq(t).addClass("disabled")});i.removeAttr("style").find("ul").removeAttr("style");i.find("li").each(function(){i.addClass("open");n.outerWidth(e(this))>r&&(r=n.outerWidth(e(this)));i.removeClass("open")})},toggle_checkbox:function(e){var t=e.prev(),n=t[0];if(!1===t.is(":disabled")){n.checked=n.checked?!1:!0;e.toggleClass("checked");t.trigger("change")}},toggle_radio:function(e){var t=e.prev(),n=t.closest("form.custom"),r=t[0];if(!1===t.is(":disabled")){n.find('input[type="radio"][name="'+this.escape(t.attr("name"))+'"]').next().not(e).removeClass("checked");e.hasClass("checked")||e.toggleClass("checked");r.checked=e.hasClass("checked");t.trigger("change")}},escape:function(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")},hidden_fix:{tmp:[],hidden:null,adjust:function(t){var n=this;n.hidden=t.parents().andSelf().filter(":hidden");n.hidden.each(function(){var t=e(this);n.tmp.push(t.attr("style"));t.css({visibility:"hidden",display:"block"})})},reset:function(){var t=this;t.hidden.each(function(n){var i=e(this),s=t.tmp[n];s===r?i.removeAttr("style"):i.attr("style",s)});t.tmp=[];t.hidden=null}},off:function(){e(this.scope).off(".fndtn.forms")}}})(Foundation.zj,this,this.document);